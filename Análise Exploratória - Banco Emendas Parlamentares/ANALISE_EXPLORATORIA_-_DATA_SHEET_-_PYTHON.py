# -*- coding: utf-8 -*-
"""Aula_IA_-_Dia_25_09_-_Atividade

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1pnX1kxh7blIhwpNaWmpdse_hYgUmOhd6

**Carregando os Dados**

# **Inteligencia Artificial**
Professor: Everson

Curso: Análise e Desenvolvimento de Sistemas

Semestre: 6° Semestre - Noturno

Nome: Pedro Henrique de Oliveira
______________

## **Tarefa - Análise Exploratória**

Faça uma análise exploratória sobre o DataSet das emendas parlamentares e:
________

***( I . ) Escreva um conjunto de instruções de apresente (obs.: Se necessário, ajuste o nome das colunas)***


A - A quantidade de emendas parlamentares.

B - A quantidade de emendas por localidade.

C - A quantidade de emendas por Autor, ordenar da maior para a menor quantidade.

D - A quantidade de emendas por Área.

E - A quantidade de emendas por Subarea, ordenar da maior para a menor quantidade.

F - A quantidade de linhas do conjunto de dados.

G - A média do valor empenhado.

H - O maior e o menor valor empenhado.

I - As primeiras 20 linhas do conjunto de dados.

J - As colunas autor, localidade, área, subárea e valor empenhado.

K - O número do partido com maior número de emendas.

L - Exibir as linhas com valor liquidado maior que zero.

M - O desvio padrão do valor empenhado.

N - O valor total empenhado em 2023.

O - O valor total empenhado por autor em ordem alfabética.

P - O valor total empenhado para cada localidade em ordem de valor.

Q - O percentual de emendas por localidade.

R - As colunas área, subarea e valor empenhado.

S - O percentual de valor empenhado por subárea.

T - Três tipos de gráficos diferentes.

U - As linhas com valores liquidados.

V - As linhas com valores liquidados e pagos.
__________

( II . ) Remover a coluna ano (gerar um novo dataset sem a coluna ano).  
______
( III . ) Existe algum valor empenhado considerado "fora do padrão"? Qual e como você encontrou?
______
( IV . ) A maioria dos valores empenhados encontram-se que qual faixa. (encontre o Quartil).
______

**Importanto as Bibliotecas**
"""

import pandas as pd
import numpy as np

"""**Carregando os Dados**"""

bd = pd.read_excel('BD_EMENDAS.xlsx')

"""_____________

A - A quantidade de emendas parlamentares.
"""

bd.EMD_NUM.sum()

"""B - A quantidade de emendas por localidade."""

bd.EMD_LOC.value_counts()

"""C - A quantidade de emendas por Autor, ordenar da maior para a menor quantidade."""

bd.EMD_NOME_AUTOR.value_counts()

"""D - A quantidade de emendas por Área."""

bd.EMD_FUNCAO.value_counts()

"""E - A quantidade de emendas por Subarea, ordenar da maior para a menor quantidade."""

bd.EMD_SUB_FUNCAO.value_counts()

"""F - A quantidade de linhas do conjunto de dados."""

bd.shape[0]

"""G - A média do valor empenhado."""

bd.EMD_VAL_EMPENHADO.mean()

"""H - O maior e o menor valor empenhado."""

bd.EMD_VAL_EMPENHADO.min()

bd.EMD_VAL_EMPENHADO.max()

"""I - As primeiras 20 linhas do conjunto de dados."""

bd.head(20)

"""J - As colunas autor, localidade, área, subárea e valor empenhado."""

i = bd.head(10)
i[['EMD_NOME_AUTOR', 'EMD_LOC', 'EMD_FUNCAO',	'EMD_SUB_FUNCAO',	'EMD_VAL_EMPENHADO']]

"""K - O número do partido com maior número de emendas."""

bd.EMD_NUM.value_counts()

"""L - Exibir as linhas com valor liquidado maior que zero."""

resultados = bd.EMD_VALOR_LIQ > 0
valores = bd.EMD_VALOR_LIQ[resultados]

print(valores)

"""M - O desvio padrão do valor empenhado."""

bd.EMD_VAL_EMPENHADO.std()

"""N - O valor total empenhado em 2023."""

bd.EMD_VAL_EMPENHADO.sum()

"""O - O valor total empenhado por autor em ordem alfabética."""

bd.groupby('EMD_NOME_AUTOR')['EMD_VAL_EMPENHADO'].sum()

"""P - O valor total empenhado para cada localidade em ordem de valor."""

x = bd.groupby('EMD_LOC')['EMD_VAL_EMPENHADO'].sum()
x = x.sort_values(ascending = True)
print(x)

"""Q - O percentual de emendas por localidade."""

bd_result = bd.groupby('EMD_LOC')['EMD_NUM'].sum()

sum_bd = bd_result.sum()

bd_result = bd_result / sum_bd * 100

print(bd_result)

"""R - As colunas área, subarea e valor empenhado."""

bd[['EMD_FUNCAO',	'EMD_SUB_FUNCAO',	'EMD_VAL_EMPENHADO']]

"""S - O percentual de valor empenhado por subárea."""

bd_result = bd.groupby('EMD_SUB_FUNCAO')['EMD_VAL_EMPENHADO'].sum()

sum_bd = bd_result.sum()

bd_result = bd_result / sum_bd * 100

print(bd_result)

"""T - Três tipos de gráficos diferentes."""

import matplotlib.pyplot as plt
import seaborn as sns

sns.set(style='whitegrid')
plt.figure(figsize=(8, 8))

bd['EMD_FUNCAO'].value_counts().head().plot(kind='pie', autopct='%1.1f%%')
plt.title('Distribuição dos Gastos por Função Principal')

plt.ylabel('')
plt.show()

import matplotlib.pyplot as plt
import seaborn as sns

sns.set(style='whitegrid')

bd.EMD_LOC.value_counts().head().plot(kind='bar')

plt.show()

import matplotlib.pyplot
import seaborn as sns

i = bd.EMD_FUNCAO.value_counts()

areas = i.index
tot = i.values

matplotlib.pyplot.barh(areas, tot)
matplotlib.pyplot.xlim(0, max(tot) + 60)

matplotlib.pyplot.ylabel('Area')
matplotlib.pyplot.xlabel('Emendas')
matplotlib.pyplot.title('QUANTIDADE DE EMENDAS POR ÁREA')

matplotlib.pyplot.show()

"""U - As linhas com valores liquidados."""

resultados = bd.EMD_VALOR_LIQ <= 0
valores = bd.EMD_VALOR_LIQ[resultados]

print(valores)

"""V - As linhas com valores liquidados e pagos."""

resultados = bd[(bd['EMD_VALOR_LIQ'] <= 0) | (bd['EMD_VAL_PAGO'] <= 0)]
valores = resultados[['EMD_VALOR_LIQ', 'EMD_VAL_PAGO']]

print(valores)