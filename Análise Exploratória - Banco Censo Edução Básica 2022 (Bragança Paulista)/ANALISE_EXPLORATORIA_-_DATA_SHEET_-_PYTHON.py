# -*- coding: utf-8 -*-
"""Aula_IA_-_Dia_02_10_-_Atividade

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1XrZkWTZMz2aQuGOi3ZxQJEQDSPqjYIf9

# **Inteligencia Artificial**
Professor: Everson

Curso: Análise e Desenvolvimento de Sistemas

Semestre: 6° Semestre - Noturno

Nome: Pedro Henrique de Oliveira
______________

# **Tarefa - Análise do DataSet - Censo Educação Básica 2022**
______

1. Extraia do DataSet somente os dados referentes a Bragança Paulista. (OK)
2. Importe para o Collab (OK)
3. Faça uma Analise Exploratória Inicial e complete os dados faltantes seguindo algum critério. obs.: consulte o dicionário de dados antes de iniciar.
4. Verifique se existe algum valor discrepante. Qual(is)? Como corrigir?
5. Remova os campos (atributos desnecessários). Justifique.
6. Verifique se todas os campos estão preenchidos corretamente e faça os ajustes necessários.
7. Encontre Insights no conjunto de dados  - (7 a 10) - (https://www.rampfy.com/blog/diferenca-entre-dados-analises-e-insights

Obs.: para plotar gráficos:
              ## gráfico de barras vertical
       dados['campo'].value_counts().plot.bar()


Entregar: O novo DataSet  e o notebook.
______

**Importanto as Bibliotecas**
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

"""**Carregando os Dados**"""

bd = pd.read_excel('BD_ED_BASICA.xlsx')

"""_______

### 3. Faça uma Analise Exploratória Inicial e complete os dados faltantes seguindo algum critério. obs.: consulte o dicionário de dados antes de iniciar.
"""

bd['TP_SITUACAO_FUNCIONAMENTO'] = bd['TP_SITUACAO_FUNCIONAMENTO'].replace(1, "ATIVA")
bd['TP_SITUACAO_FUNCIONAMENTO'] = bd['TP_SITUACAO_FUNCIONAMENTO'].replace(2, "INATIVA")

bd[['NO_ENTIDADE', 'TP_SITUACAO_FUNCIONAMENTO']]

bd['TP_DEPENDENCIA'] = bd['TP_DEPENDENCIA'].replace(1, "FEDERAL")
bd['TP_DEPENDENCIA'] = bd['TP_DEPENDENCIA'].replace(2, "ESTADUAL")
bd['TP_DEPENDENCIA'] = bd['TP_DEPENDENCIA'].replace(3, "MUNICIPAL")
bd['TP_DEPENDENCIA'] = bd['TP_DEPENDENCIA'].replace(4, "PRIVADA")

bd[['NO_ENTIDADE', 'TP_DEPENDENCIA']]

bd['TP_LOCALIZACAO'] = bd['TP_LOCALIZACAO'].replace(1, "URBANA")
bd['TP_LOCALIZACAO'] = bd['TP_LOCALIZACAO'].replace(2, "RURAL")

bd[['NO_ENTIDADE', 'TP_LOCALIZACAO']]

bd[['NO_ENTIDADE', 'TP_LOCALIZACAO', 'TP_DEPENDENCIA', 'TP_SITUACAO_FUNCIONAMENTO']]

"""### 4. Verifique se existe algum valor discrepante. Qual(is)? Como corrigir?
Ajuste realizado no formato da data e hora
"""

import pandas as pd
from datetime import datetime

dataArray = bd['DT_ANO_LETIVO_INICIO']

df = pd.DataFrame({"DataOriginal": dataArray})

def formatar_data(data_original):
    if isinstance(data_original, str) and data_original:
        data_formatada = datetime.strptime(data_original, "%d%b%Y:%H:%M:%S")
        return data_formatada.strftime('%Y-%m-%d %H:%M:%S')
    else:
        return data_original

df["DataOriginal"] = df["DataOriginal"].apply(formatar_data)

bd["DT_ANO_LETIVO_INICIO"] = df["DataOriginal"]

print(df)

bd[['NO_ENTIDADE', 'DT_ANO_LETIVO_INICIO']]

"""### 5. Remova os campos (atributos desnecessários). Justifique.
Os campos removidos foram os respectivamente, Nome da Região por já ser apresentado por sua sigla, seu código devido o constesto atual ser irrelevante, o código do municipio removido também pelo mesmo motivo, o código da UF por já estar sendo representado pela silga SP e o nome da UF por também já estar sendo representada pala sigla SP.
"""

del bd['NO_REGIAO']
del bd['CO_REGIAO']
del bd['CO_MUNICIPIO']
del bd['CO_UF']
del bd['NO_UF']

bd.head()

"""### 6. Verifique se todas os campos estão preenchidos corretamente e faça os ajustes necessários."""

bd['TP_SITUACAO_FUNCIONAMENTO'] = bd['TP_SITUACAO_FUNCIONAMENTO'].replace(1, "EM ATIVIDADE")
bd['TP_SITUACAO_FUNCIONAMENTO'] = bd['TP_SITUACAO_FUNCIONAMENTO'].replace(2, "PARALISADA")
bd['TP_SITUACAO_FUNCIONAMENTO'] = bd['TP_SITUACAO_FUNCIONAMENTO'].replace(3, "EXTINTA NO ANO DO CENSO")
bd['TP_SITUACAO_FUNCIONAMENTO'] = bd['TP_SITUACAO_FUNCIONAMENTO'].replace(4, "EXTITAS EM ANOS ANTERIORES")

bd[['NO_ENTIDADE', 'TP_SITUACAO_FUNCIONAMENTO']]

bd['IN_VINCULO_SECRETARIA_EDUCACAO'] = bd['IN_VINCULO_SECRETARIA_EDUCACAO'].replace(1, "NÃO")
bd['IN_VINCULO_SECRETARIA_EDUCACAO'] = bd['IN_VINCULO_SECRETARIA_EDUCACAO'].replace(2, "SIM")
bd['IN_VINCULO_SECRETARIA_EDUCACAO'] = bd['IN_VINCULO_SECRETARIA_EDUCACAO'].replace(3, "NÃO APLICADA PARA ESCOLAS PRIVADAS")

bd[['NO_ENTIDADE', 'IN_VINCULO_SECRETARIA_EDUCACAO']]

"""### 7. Encontre Insights no conjunto de dados - (7 a 10) - (https://www.rampfy.com/blog/diferenca-entre-dados-analises-e-insights"""

# Numero de escolas em funcionamento

bd['TP_SITUACAO_FUNCIONAMENTO'].value_counts().plot(kind='bar')

plt.title('Situação de Funcionamento')
plt.xlabel('Funcionamento')
plt.ylabel('Quantidade de Escolas')

plt.xticks([0, 1], ['Sim', 'Não'])

plt.show()

# Quantidades de escolas de acordo com sua dependencia

bd['TP_DEPENDENCIA'].value_counts().plot(kind='bar')

plt.title('Dependencias')
plt.xlabel('Tipo de Dependencias')
plt.ylabel('Quantidade de Escolas')

plt.xticks([0,1,2,3], ["Federal", "Estadual", "Municipal", "Privada"])

plt.show()

# Quantidade de Escolas de acordo com a localização.

bd['TP_LOCALIZACAO'].value_counts().plot(kind='bar')

plt.title('Localização')
plt.xlabel('Tipo de Localização')
plt.ylabel('Quantidade de Escolas')

plt.xticks([0, 1], ["Urbana", "Rural"])

plt.show()

# Porcentagem por situação de funcionamento
plt.figure(figsize=(6, 6))

contagem = bd['TP_SITUACAO_FUNCIONAMENTO'].value_counts()

plt.pie(contagem, labels=contagem.index, autopct='%1.1f%%')
plt.title('Funcionamento por Porcentagem (1) Em atividade (2) Paralisada')

plt.show()

# Localidade escolares

bd['TP_LOCALIZACAO'].value_counts().plot(kind='bar')

plt.title('Escola e suas respectivas Localidades')
plt.xlabel('')
plt.ylabel('Quantidade de Escolas')

plt.xticks([0, 1], ["Urbana", "Rural"])

plt.xticks(rotation=0)

plt.show()

# Anlise escolas e secretária

bd['IN_VINCULO_SECRETARIA_EDUCACAO'].value_counts().plot(kind='bar')

plt.title('Associação Escolas x Secretaria')
plt.xlabel('')
plt.ylabel('Quantidade de Escolas')

plt.xticks([0, 1], ["Possui", "Não Possui"])

plt.xticks(rotation=0)

plt.show()

# Porcentagem por região

plt.figure(figsize=(6, 6))

contagem = bd['TP_LOCALIZACAO'].value_counts()

plt.pie(contagem, labels=contagem.index, autopct='%1.1f%%')
plt.title('Porcentagem em região (1) Urbana (2) Rural')

plt.show()